likwid_pref="likwid-perfctr -g FLOPS_DP -m ./build/benchmark-"
out_com() { echo "> ../results/${1}_likwid 2> ../results/${1}_rt" ; }
chmod +x build/benchmark-*
for N in 128 512 2048; do
  for T in 1 4 16 64; do
    # set threads
    export OMP_NUM_THREADS=$T
    echo $OMP_NUM_THREADS

    # blas
    if [ $T -eq 1 ]; then
      eval "${likwid_pref}blas" -N $N $(out_com "blas_${N}")
    fi

    # basic
    eval "${likwid_pref}basic-omp" -N $N $(out_com "basic_${N}_${T}")

    # blocked
    for B in 4 16; do
      eval "${likwid_pref}blocked-omp" -N $N -B $B $(out_com "blocked_${N}_${T}_${B}")
    done

    # strassen
    for L in 64 256 512; do
      eval "${likwid_pref}strassen-$L-omp" -N $N $(out_com "strassen_${N}_${T}_${L}")
    done

  done
done